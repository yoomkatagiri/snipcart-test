<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Snipcart テスト購入</title>
  <!-- Snipcart CSS & JS -->
  <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.4.0/default/snipcart.css" />
  <script async src="https://cdn.snipcart.com/themes/v3.4.0/default/snipcart.js"></script>
</head>
<body>
  <h1>テスト購入ページ</h1>

  <!-- 商品ボタンをJSONから自動生成 -->
  <div id="products-container"></div>

  <!-- Snipcart 本体 -->
  <div hidden id="snipcart" data-api-key="NzU0OTljZjgtNjM3My00ODE0LWEyMzgtODMwNDcwZDRkMzUyNjM4ODU2NDgyMzMxMjEyNjk1"></div>

  <script>
    // JSONのURL
    const productsJsonUrl = "https://yoomkatagiri.github.io/snipcart-test/products.json";

    // 商品を読み込んでボタンを作る
    fetch(productsJsonUrl)
      .then(response => response.json())
      .then(products => {
        const container = document.getElementById("products-container");
        products.forEach(product => {
          const btn = document.createElement("button");
          btn.className = "snipcart-add-item";
          btn.setAttribute("data-item-id", product.id);
          btn.setAttribute("data-item-name", product.name);
          btn.setAttribute("data-item-price", product.price);
          btn.setAttribute("data-item-url", productsJsonUrl); // JSONを参照
          btn.setAttribute("data-item-description", product.name + "です");
          btn.textContent = product.name + " をカートに入れる";
          container.appendChild(btn);
          container.appendChild(document.createElement("br"));
        });
      })
      .catch(err => {
        console.error("商品読み込みエラー:", err);
      });
  </script>
</body>
</html>
